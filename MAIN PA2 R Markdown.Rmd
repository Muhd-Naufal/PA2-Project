---
title: "PA2 CA2"
output:
  html_document: default
  pdf_document: default
---
```{r libraries, include= FALSE}
library(dplyr)
library(RColorBrewer)
library(leaflet)
library(geojsonio)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r map stuff, echo=FALSE, include= FALSE}
mymap = leaflet()
mymap

town <- geojsonio::geojson_read("MP14_PLNG_AREA_NO_SEA_PL.geojson", what = "sp")
class(town)
names(town)

m <- leaflet(town) %>%
  setView(mymap, lat=1.290270, lng =103.851959, zoom = 11) %>%
  addTiles()

m %>% addPolygons()

library(RColorBrewer)
factpal <- colorFactor(brewer.pal(n = 11, name ="Spectral") , town$Name)

labels <- sprintf(
  "<strong>%s</strong><br/>%s",
  town$Name, town$Region.Name
) %>% lapply(htmltools::HTML)
```

## Map of Singapore
This is an interactive map showing the different towns and their regions.
```{r map, echo=FALSE}
m <- m %>% addPolygons(
  fillColor = ~factpal(town$Name),
  weight = 2,
  opacity = 1,
  color = "white",
  dashArray = "3",
  fillOpacity = 0.7,
  highlight = highlightOptions(
    weight = 5,
    color = "#666",
    dashArray = "",
    fillOpacity = 0.7,
    bringToFront = TRUE),
  label = labels,
  labelOptions = labelOptions(
    style = list("font-weight" = "normal", padding = "3px 8px"),
    textsize = "15px",
    direction = "auto"))
m
```

```{r mrt stuff, echo=FALSE, include = FALSE}
mrt<-read.csv("mrtsg.csv")
mrt<- as.data.frame(mrt)
mrt

leaflet() %>%
  addTiles() %>%
  #addMarkers(data = mrt, lat = ~Latitude, lng = ~Longitude)
  addCircleMarkers(data = mrt, lat = ~Latitude, lng = ~Longitude)

pal <- colorFactor(levels = c("RED", "BLUE", "GREEN","YELLOW","PURPLE","BROWN","GREY"),
                   palette = c("red", "blue", "green","yellow","purple","brown","grey"))
```


```{r mrt , echo=FALSE}

leaflet() %>%
  addTiles() %>%
  #addMarkers(data = mrt, lat = ~Latitude, lng = ~Longitude)
  addCircleMarkers(data = mrt, 
                   radius = 8, 
                   color = ~pal(COLOR),
                   stroke = FALSE, 
                   fillOpacity = 0.7, 
                   lat = ~Latitude, lng = ~Longitude)
```
maybe can add white polygon behind layer so it's clearer
and add mrt station names when highlight above marker
