---
title: "R MARKDOWN REPORT"
author: "Javier, E Lynn,AJ, Zulfikar, Ashraf, Naufal"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  prettydoc::html_pretty:
    highlight: github
    theme: cayman
---
  
```{r libraries, include= FALSE}
#install.packages("prettydoc")
library(prettydoc)
library(plyr)
library(dplyr)
library(RColorBrewer)
library(leaflet)
library(geojsonio)
library(ggplot2)
library(gganimate)
library(gifski)
library(data.table)
library(ggrepel)
library(plotly)
library(shiny)
library(rgeos)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

***
# Contents

* **Headlines**
  + Forecasting Tengah Town
  + Is $1m HDB becoming the norm?
  + Predicting **YOUR MUM**
  
<br>

* **Visualizations**
  + Remaking Our Heartland 
  + Relationship Between POI and Resale Price
  + Why Prices Drastically Increase From 2007 Onwards 
  + Value Comparison Between Mature Towns And Non-Mature Towns
  + Does Premium/Non-standard HDBs account for high resale value? 
  + Compare HDB Median Resale Price Per Town
 
***

## Headlines

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

&nbsp;
&nbsp;

## Headline 1

``` {r H1G1 Code, echo=FALSE, include=FALSE}

Punggol <- read.csv("./Datasets/HDB Resale Prices.csv")
Punggol$month <- as.Date(paste0(Punggol$month, "-01"), "%Y-%m-%d")
Punggol$year <- format(as.Date(Punggol$month, format="%Y-%m-%d"),"%Y")
Punggol2 <- filter(Punggol, month >= "2007-01-01",town == "PUNGGOL")

type22007<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2007")
type22008<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2008")
type22009<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2009")
type22010<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2010")
type22011<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2011")
type22012<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2012")
type22013<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2013")
type22014<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2014")
type22015<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2015")
type22016<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2016")
type22017<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2017")

a2007<-as.integer(mean(type22007$resale_price))
a2008<-as.integer(mean(type22008$resale_price))
a2009<-as.integer(mean(type22009$resale_price))
a2010<-as.integer(mean(type22010$resale_price))
a2011<-as.integer(mean(type22011$resale_price))
a2012<-as.integer(mean(type22012$resale_price))
a2013<-as.integer(mean(type22013$resale_price))
a2014<-as.integer(mean(type22014$resale_price))
a2015<-as.integer(mean(type22015$resale_price))
a2016<-as.integer(mean(type22016$resale_price))
a2017<-as.integer(mean(type22017$resale_price))

type32007<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2007")
type32008<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2008")
type32009<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2009")
type32010<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2010")
type32011<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2011")
type32012<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2012")
type32013<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2013")
type32014<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2014")
type32015<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2015")
type32016<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2016")
type32017<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2017")

b2007<-as.integer(mean(type32007$resale_price))
b2008<-as.integer(mean(type32008$resale_price))
b2009<-as.integer(mean(type32009$resale_price))
b2010<-as.integer(mean(type32010$resale_price))
b2011<-as.integer(mean(type32011$resale_price))
b2012<-as.integer(mean(type32012$resale_price))
b2013<-as.integer(mean(type32013$resale_price))
b2014<-as.integer(mean(type32014$resale_price))
b2015<-as.integer(mean(type32015$resale_price))
b2016<-as.integer(mean(type32016$resale_price))
b2017<-as.integer(mean(type32017$resale_price))

type42007<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2007")
type42008<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2008")
type42009<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2009")
type42010<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2010")
type42011<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2011")
type42012<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2012")
type42013<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2013")
type42014<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2014")
type42015<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2015")
type42016<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2016")
type42017<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2017")

c2007<-as.integer(mean(type42007$resale_price))
c2008<-as.integer(mean(type42008$resale_price))
c2009<-as.integer(mean(type42009$resale_price))
c2010<-as.integer(mean(type42010$resale_price))
c2011<-as.integer(mean(type42011$resale_price))
c2012<-as.integer(mean(type42012$resale_price))
c2013<-as.integer(mean(type42013$resale_price))
c2014<-as.integer(mean(type42014$resale_price))
c2015<-as.integer(mean(type42015$resale_price))
c2016<-as.integer(mean(type42016$resale_price))
c2017<-as.integer(mean(type42017$resale_price))

type52007<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2007")
type52008<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2008")
type52009<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2009")
type52010<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2010")
type52011<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2011")
type52012<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2012")
type52013<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2013")
type52014<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2014")
type52015<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2015")
type52016<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2016")
type52017<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2017")

d2007<-as.integer(mean(type52007$resale_price))
d2008<-as.integer(mean(type52008$resale_price))
d2009<-as.integer(mean(type52009$resale_price))
d2010<-as.integer(mean(type52010$resale_price))
d2011<-as.integer(mean(type52011$resale_price))
d2012<-as.integer(mean(type52012$resale_price))
d2013<-as.integer(mean(type52013$resale_price))
d2014<-as.integer(mean(type52014$resale_price))
d2015<-as.integer(mean(type52015$resale_price))
d2016<-as.integer(mean(type52016$resale_price))
d2017<-as.integer(mean(type52017$resale_price))

type62007<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2007")
type62008<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2008")
type62009<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2009")
type62010<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2010")
type62011<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2011")
type62012<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2012")
type62013<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2013")
type62014<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2014")
type62015<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2015")
type62016<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2016")
type62017<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2017")

e2007<-as.integer(mean(type62007$resale_price))
e2008<-as.integer(mean(type62008$resale_price))
e2009<-as.integer(mean(type62009$resale_price))
e2010<-as.integer(mean(type62010$resale_price))
e2011<-as.integer(mean(type62011$resale_price))
e2012<-as.integer(mean(type62012$resale_price))
e2013<-as.integer(mean(type62013$resale_price))
e2014<-as.integer(mean(type62014$resale_price))
e2015<-as.integer(mean(type62015$resale_price))
e2016<-as.integer(mean(type62016$resale_price))
e2017<-as.integer(mean(type62017$resale_price))

type4and52007<-filter(Punggol2, Punggol2$year=="2007"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52008<-filter(Punggol2, Punggol2$year=="2008"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52009<-filter(Punggol2, Punggol2$year=="2009"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52010<-filter(Punggol2, Punggol2$year=="2010"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52011<-filter(Punggol2, Punggol2$year=="2011"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52012<-filter(Punggol2, Punggol2$year=="2012"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52013<-filter(Punggol2, Punggol2$year=="2013"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52014<-filter(Punggol2, Punggol2$year=="2014"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type23452015<-filter(Punggol2, Punggol2$year=="2015"| Punggol2$flat_type=="2 ROOM"& Punggol2$flat_type=="3 ROOM"&Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type23452016<-filter(Punggol2, Punggol2$year=="2016"| Punggol2$flat_type=="2 ROOM"& Punggol2$flat_type=="3 ROOM"&Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type23452017<-filter(Punggol2, Punggol2$year=="2017"| Punggol2$flat_type=="2 ROOM"& Punggol2$flat_type=="3 ROOM"&Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")

f2007<-as.integer(mean(type4and52007$resale_price))
f2008<-as.integer(mean(type4and52008$resale_price))
f2009<-as.integer(mean(type4and52009$resale_price))
f2010<-as.integer(mean(type4and52010$resale_price))
f2011<-as.integer(mean(type4and52011$resale_price))
f2012<-as.integer(mean(type4and52012$resale_price))
f2013<-as.integer(mean(type4and52013$resale_price))
f2014<-as.integer(mean(type4and52014$resale_price))
f2015<-as.integer(mean(type23452015$resale_price))
f2016<-as.integer(mean(type23452016$resale_price))
f2017<-as.integer(mean(type23452017$resale_price))

Year <- c("2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017")

tworoom <- c(a2007,a2008,a2009,a2010,a2011,a2012,a2013,a2014,a2015,a2016,a2017)
threeroom <- c(b2007,b2008,b2009,b2010,b2011,b2012,b2013,b2014,b2015,b2016,b2017)
fourroom <- c(c2007,c2008,c2009,c2010,c2011,c2012,c2013,c2014,c2015,c2016,c2017)
fiveroom <- c(d2007,d2008,d2009,d2010,d2011,d2012,d2013,d2014,d2015,d2016,d2017)
executive <- c(e2007,e2008,e2009,e2010,e2011,e2012,e2013,e2014,e2015,e2016,e2017)
average <- c(f2007,f2008,f2009,f2010,f2011,f2012,f2013,f2014,f2015,f2016,f2017)

Punggoldf <- data.frame(Year,tworoom,threeroom,fourroom,fiveroom,executive,average)

is.nan.data.frame <- function(x)
  do.call(cbind, lapply(x, is.nan))

Punggoldf[is.nan(Punggoldf)] <- 0
```

```{r H1G1, message = FALSE, warning = FALSE, echo=FALSE }

plot_ly(
  type = 'table',
  header = list(
    values = c('<b>YEAR</b>', '<b>2 Room</b>','<b>3 Room</b>','<b>4 Room</b>','<b>5 Room</b>','<b>Executive<b>','<b>Total<b>'),
    line = list(color = '#506784'),
    fill = list(color = 'red'),
    align = c('left','center'),
    font = list(color = 'black', size = 12)
  ),
  cells = list(
    values = rbind(
      c("2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017", '<b>2008 vs 2018</b>'),
      c(a2007,a2008,a2009,a2010,a2011,a2012,a2013,a2014,a2015,a2016,a2017,"null"),
      c(b2007,b2008,b2009,b2010,b2011,b2012,b2013,b2014,b2015,b2016,b2017,"null"),
      c(c2007,c2008,c2009,c2010,c2011,c2012,c2013,c2014,c2015,c2016,c2017,"71.4%"),
      c(d2007,d2008,d2009,d2010,d2011,d2012,d2013,d2014,d2015,d2016,d2017,"48.2%"),
      c(e2007,e2008,e2009,e2010,e2011,e2012,e2013,e2014,e2015,e2016,e2017,"41.6%"),
      c(f2007,f2008,f2009,f2010,f2011,f2012,f2013,f2014,f2015,f2016,f2017,"50.5%")),
    line = list(color = '#506784'),
    fill = list(color = c('red', 'white')),
    align = c('left', 'center'),
    font = list(color = c('black'), size = 12)
  ))
```
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

```{r H1G2 Code, message = FALSE, warning = FALSE, results = FALSE,echo=FALSE}

Price <- c(a2007,a2008,a2009,a2010,a2011,a2012,a2013,a2014,a2015,a2016,a2017,
           b2007,b2008,b2009,b2010,b2011,b2012,b2013,b2014,b2015,b2016,b2017,
           c2007,c2008,c2009,c2010,c2011,c2012,c2013,c2014,c2015,c2016,c2017,
           d2007,d2008,d2009,d2010,d2011,d2012,d2013,d2014,d2015,d2016,d2017,
           e2007,e2008,e2009,e2010,e2011,e2012,e2013,e2014,e2015,e2016,e2017,
           f2007,f2008,f2009,f2010,f2011,f2012,f2013,f2014,f2015,f2016,f2017)

Years <- c("2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017")

Flat_Type <- c("2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room",
               "3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room",
               "4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room",
               "5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room",
               "Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive",
               "Average","Average","Average","Average","Average","Average","Average","Average","Average","Average","Average")

kgif <- data.frame(Price,Years,Flat_Type)
kgif$Price <- as.numeric(as.character(kgif$Price))
kgif$Years <- as.numeric(as.character(kgif$Years))

```

```{r H1G2, message = FALSE, warning = FALSE, results = FALSE, echo=FALSE}
k <- ggplot(
  kgif,
  aes(Years,Price, group = Flat_Type, color = factor(Flat_Type), label = Flat_Type)
) +
  geom_line() +
  scale_color_viridis_d() +
  labs(x = "Years", y = "Yceffc") +
  ggtitle("TITLE") +
  theme(legend.position = "top") +
  guides(color=guide_legend(title="Flat Type")) +
  geom_label() +
  geom_point(aes(group = seq_along(Years)), size = 7) +
  transition_reveal(Years)

anim_save("k.gif", k)
```

![](k.gif)
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.


## Headline 2

```{r H2G1 Code, echo=FALSE, include=FALSE}

hdb2 <- read.csv("./Datasets/HDB Resale Prices.csv")

hdb2$month <- as.Date(paste0(hdb2$month, "-01"), "%Y-%m-%d")

hdb3 <- filter(hdb2, month >= "2012-01-01")

hdb4 <- filter(hdb3, flat_type == "4 ROOM" | 
                     flat_type == "5 ROOM" | 
                     flat_type == "EXECUTIVE" | 
                     flat_type == "MULTI-GENERATION")

hdb5 <- filter(hdb4, resale_price >= 900000)

hdb6 <- count(hdb5, "flat_type")

hdb7 <- data.frame(hdb5$flat_type, hdb5$resale_price, hdb5$month)

hdb7$hdb5.resale_price <- 1

sum(hdb7$hdb5.resale_price)
```

```{r H2G1, echo=FALSE}
setDT(hdb7)[,hdb5.month := as.IDate(hdb5.month)]
ggplot(hdb7[,sum(hdb5.resale_price), by=.(hdb5.flat_type, year(hdb5.month))], aes(x=year, y=V1, fill=hdb5.flat_type)) +
  geom_bar(stat = "identity") +
  geom_label_repel(aes(label=V1), vjust=0) +
  ggtitle("Resale flats above $900K by Year") +
  xlab("Year") + ylab("Transaction Volume") +
  labs(fill='Flat Type') 
```

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

```{r H2G2 code, message = FALSE, warning = FALSE, results = FALSE,echo=FALSE}
hdb8 <- filter(hdb3, flat_type == "4 ROOM" | 
                 flat_type == "5 ROOM" | 
                 flat_type == "EXECUTIVE" | 
                 flat_type == "MULTI-GENERATION")

hdb9 <- data.frame(hdb8$flat_type, hdb8$month)

hdb9$year <- substring(hdb9$hdb8.month,1,4)

i <- sapply(hdb9, is.factor)
hdb9[i] <- lapply(hdb9[i], as.character)

hdb9$year <- as.numeric(as.character(hdb9$year))

hdb4R2012 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2012'))
hdb5R2012 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2012'))
hdbEX2012 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2012'))
hdbMG2012 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2012'))

hdb4R2013 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2013'))
hdb5R2013 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2013'))
hdbEX2013 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2013'))
hdbMG2013 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2013'))

hdb4R2014 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2014'))
hdb5R2014 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2014'))
hdbEX2014 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2014'))
hdbMG2014 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2014'))

hdb4R2015 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2015'))
hdb5R2015 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2015'))
hdbEX2015 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2015'))
hdbMG2015 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2015'))

hdb4R2016 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2016'))
hdb5R2016 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2016'))
hdbEX2016 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2016'))
hdbMG2016 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2016'))

hdb4R2017 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2017'))
hdb5R2017 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2017'))
hdbEX2017 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2017'))
hdbMG2017 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2017'))

Volume <- c(hdb4R2012,hdb4R2013,hdb4R2014,hdb4R2015,hdb4R2016,hdb4R2017,
            hdb5R2012,hdb5R2013,hdb5R2014,hdb5R2015,hdb5R2016,hdb5R2017,
            hdbEX2012,hdbEX2013,hdbEX2014,hdbEX2015,hdbEX2016,hdbEX2017,
            hdbMG2012,hdbMG2013,hdbMG2014,hdbMG2015,hdbMG2016,hdbMG2017)


Flat_Type <- c("4 Room","4 Room","4 Room","4 Room","4 Room","4 Room",
               "5 Room","5 Room","5 Room","5 Room","5 Room","5 Room",
               "Executive","Executive","Executive","Executive","Executive","Executive",
               "Multi-Generation","Multi-Generation","Multi-Generation","Multi-Generation","Multi-Generation","Multi-Generation")

Year <- c("2012","2013","2014","2015","2016","2017",
          "2012","2013","2014","2015","2016","2017",
          "2012","2013","2014","2015","2016","2017",
          "2012","2013","2014","2015","2016","2017")


finalhdb <- data.frame(Volume,Year,Flat_Type)

finalhdb$Year <- as.numeric(as.character(finalhdb$Year))
```

```{r H2G2, message = FALSE, warning = FALSE, results = FALSE, echo=FALSE}
p <- ggplot(
  finalhdb,
  aes(Year,Volume, group = Flat_Type, color = factor(Flat_Type), label = Flat_Type)
) +
  geom_line() +
  scale_color_viridis_d() +
  labs(x = "Years", y = "Transaction Volume") +
  ggtitle("Volume of flats sold over the years") +
  theme(legend.position = "top") +
  guides(color=guide_legend(title="Flat Type")) +
  geom_label() +
  geom_point(aes(group = seq_along(Year)), size = 7) +
  transition_reveal(Year)

anim_save("p.gif", p)

```

![](p.gif)
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

## Predictive Model

Still trying to make it work...

## Visualization 1

```{r V1G1 Code, echo=FALSE, include=FALSE}

#Headline 1: Remaking our Heartland

raw1<-read.csv("./Datasets/HDB Resale Prices.csv")

#regroup data to year
year<-substr(raw1$month, start = 1, stop = 4)
df<-as.data.frame(year)
raw<-cbind(df,raw1)

#select towns with ROH
library(dplyr)
towndata<-raw%>%
  select(year,town,resale_price)

rohvalues<-which(towndata$town=="PUNGGOL"|
                   towndata$town=="YISHUN"|
                   towndata$town=="QUEENSTOWN"|
                   towndata$town=="MARINE PARADE"|
                   towndata$town=="HOUGANG"|
                   towndata$town=="JURONG EAST"|
                   towndata$town=="TOA PAYOH"|
                   towndata$town=="WOODLANDS"|
                   towndata$town=="PASIR RIS")

rohdf<-towndata[rohvalues,]

#change year from factor to numeric
rohdf$year <- as.numeric(as.character(rohdf$year))
str(rohdf)

#prices before ROH
pgb1<-which(rohdf$town=="PUNGGOL" & rohdf$year<2007)
pgb2<-rohdf[pgb1,]
punggolbef<-mean(pgb2$resale_price)

yishunb1<-which(rohdf$town=="YISHUN" & rohdf$year<2007)
ysb2<-rohdf[yishunb1,]
yishunbef<-mean(ysb2$resale_price)

qsb1<-which(rohdf$town=="QUEENSTOWN" & rohdf$year<2007)
qsb2<-rohdf[qsb1,]
queenstownbef<-mean(qsb2$resale_price)

mpb1<-which(rohdf$town=="MARINE PARADE" & rohdf$year<2011)
mpb2<-rohdf[mpb1,]
mpbef<-mean(mpb2$resale_price)

hgb1<-which(rohdf$town=="HOUGANG" & rohdf$year<2011)
hgb2<-rohdf[hgb1,]
hgbef<-mean(hgb2$resale_price)

jeb1<-which(rohdf$town=="JURONG EAST" & rohdf$year<2011)
jeb2<-rohdf[jeb1,]
jebef<-mean(jeb2$resale_price)

tpb1<-which(rohdf$town=="TOA PAYOH" & rohdf$year<2015)
tpb2<-rohdf[tpb1,]
tpbef<-mean(tpb2$resale_price)

wb1<-which(rohdf$town=="WOODLANDS" & rohdf$year<2015)
wb2<-rohdf[wb1,]
woodbef<-mean(wb2$resale_price)

prb1<-which(rohdf$town=="PASIR RIS" & rohdf$year<2015)
prb2<-rohdf[prb1,]
prbef<-mean(prb2$resale_price)

#prices after ROH

pga1<-which(rohdf$town=="PUNGGOL" & rohdf$year>2006)
pga2<-rohdf[pga1,]
punggolaft<-mean(pga2$resale_price)

ysa1<-which(rohdf$town=="YISHUN" & rohdf$year>2006)
ysa2<-rohdf[ysa1,]
yishunaft<-mean(ysa2$resale_price)

qsa1<-which(rohdf$town=="QUEENSTOWN" & rohdf$year>2006)
qsa2<-rohdf[qsa1,]
queenstownaft<-mean(qsa2$resale_price)

mpa1<-which(rohdf$town=="MARINE PARADE" & rohdf$year>2010)
mpa2<-rohdf[mpa1,]
mpaft<-mean(mpa2$resale_price)

hga1<-which(rohdf$town=="HOUGANG" & rohdf$year>2010)
hga2<-rohdf[hga1,]
hgaft<-mean(hga2$resale_price)

jea1<-which(rohdf$town=="JURONG EAST" & rohdf$year>2010)
jea2<-rohdf[jea1,]
jeaft<-mean(jea2$resale_price)

tpa1<-which(rohdf$town=="TOA PAYOH" & rohdf$year>2014)
tpa2<-rohdf[tpa1,]
tpaft<-mean(tpa2$resale_price)

wa1<-which(rohdf$town=="WOODLANDS" & rohdf$year>2014)
wa2<-rohdf[wa1,]
woodaft<-mean(wa2$resale_price)

pra1<-which(rohdf$town=="PASIR RIS" & rohdf$year>2014)
pra2<-rohdf[pra1,]
praft<-mean(pra2$resale_price)

#price difference due to ROH
dpunggol<-punggolaft-punggolbef
dyishun<-yishunaft-yishunbef
dqueenstown<-queenstownaft-queenstownbef
dmarineparade<-mpaft-mpbef
dhougang<-hgaft-hgbef
djurongeast<-jeaft-jebef
dtoapayoh<-tpaft-tpbef
dwoodlands<-woodaft-woodbef
dpasirris<-praft-prbef

#combine as vectors
Punggol<-c("Punggol",punggolbef,punggolaft,dpunggol)
Yishun<-c("Yishun",yishunbef,yishunaft,dyishun)
Queenstown<-c("Queenstown",queenstownbef,queenstownaft,dqueenstown)
MarineParade<-c("Marine Parade",mpbef,mpaft,dmarineparade)
Hougang<-c("Hougang",hgbef,hgaft,dhougang)
JurongEast<-c("Jurong East",jebef,jeaft,djurongeast)
ToaPayoh<-c("Toa Payoh",tpbef,tpaft,dtoapayoh)
Woodlands<-c("Woodlands",woodbef,woodaft,dwoodlands)
PasirRis<-c("Pasir Ris",prbef,praft,dpasirris)

#combine
prices<-data.frame(Punggol,Yishun,Queenstown,MarineParade,Hougang,JurongEast,ToaPayoh,Woodlands,PasirRis)
prices<-t(prices)

#rename column name
colnames(prices)<-c("Town","Prices before ROH","Prices after ROH","Price Difference due to ROH")
pricesfinal<-data.frame(prices)

#melt columns
library(reshape2)
melted<-melt(pricesfinal,id.vars="Town",measure.vars = c("Prices.before.ROH","Prices.after.ROH"))

#convert values from character to integer
melted$value <- as.numeric(as.character(melted$value))
str(melted)
```

```{r V1G1, echo=FALSE}

library(ggplot2)
plot1<-ggplot(melted,aes(x=Town,y=value,fill=variable))+
  geom_bar(stat="identity",position='dodge')+
  ggtitle("Average Differences in Prices due to ROH")+xlab("ROH Town")+ylab("Amount")+
  theme(
    plot.title=element_text(color="black",size=12,face="bold.italic",hjust=0.5),
    axis.title.x = element_text(color="blue",size=12,face="bold"),
    axis.title.y = element_text(color="blue",size=12,face="bold")
    
  )

#rescale
plot1<-plot1+scale_y_continuous(breaks=seq(150000,1000000,by=100000))

plot1final<-ggplotly(plot1)
plot1final
```
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

```{r V1G2 Code, echo=FALSE, include=FALSE}
#Plot 2 - Line plot

#top town with highest increase from ROH
top1<-raw%>%
  select(year,town,resale_price)

top3a<-which(towndata$town=="QUEENSTOWN")

top3b<-top1[top3a,]

#average price

y2000w<-which(top3b$year==2000)
y2000w2<-top3b[y2000w,]
mean2000<-mean(y2000w2$resale_price)

y2001w<-which(top3b$year==2001)
y2001w2<-top3b[y2001w,]
mean2001<-mean(y2001w2$resale_price)

y2002w<-which(top3b$year==2002)
y2002w2<-top3b[y2002w,]
mean2002<-mean(y2002w2$resale_price)

y2003w<-which(top3b$year==2003)
y2003w2<-top3b[y2003w,]
mean2003<-mean(y2003w2$resale_price)

y2004w<-which(top3b$year==2004)
y2004w2<-top3b[y2004w,]
mean2004<-mean(y2004w2$resale_price)

y2005w<-which(top3b$year==2005)
y2005w2<-top3b[y2005w,]
mean2005<-mean(y2005w2$resale_price)

y2006w<-which(top3b$year==2006)
y2006w2<-top3b[y2006w,]
mean2006<-mean(y2006w2$resale_price)

y2007w<-which(top3b$year==2007)
y2007w2<-top3b[y2007w,]
mean2007<-mean(y2007w2$resale_price)

y2008w<-which(top3b$year==2008)
y2008w2<-top3b[y2008w,]
mean2008<-mean(y2008w2$resale_price)

y2009w<-which(top3b$year==2009)
y2009w2<-top3b[y2009w,]
mean2009<-mean(y2009w2$resale_price)

y2010w<-which(top3b$year==2010)
y2010w2<-top3b[y2010w,]
mean2010<-mean(y2010w2$resale_price)

y2011w<-which(top3b$year==2011)
y2011w2<-top3b[y2011w,]
mean2011<-mean(y2011w2$resale_price)

y2012w<-which(top3b$year==2012)
y2012w2<-top3b[y2012w,]
mean2012<-mean(y2012w2$resale_price)

y2013w<-which(top3b$year==2013)
y2013w2<-top3b[y2013w,]
mean2013<-mean(y2013w2$resale_price)

y2014w<-which(top3b$year==2014)
y2014w2<-top3b[y2014w,]
mean2014<-mean(y2014w2$resale_price)

y2015w<-which(top3b$year==2015)
y2015w2<-top3b[y2015w,]
mean2015<-mean(y2015w2$resale_price)

y2016w<-which(top3b$year==2016)
y2016w2<-top3b[y2016w,]
mean2016<-mean(y2016w2$resale_price)

y2017w<-which(top3b$year==2017)
y2017w2<-top3b[y2017w,]
mean2017<-mean(y2017w2$resale_price)

#combine mean
meantab<-c(mean2000,mean2001,mean2002,mean2003,mean2004,mean2005,
              mean2006,mean2007,mean2008,mean2009,mean2010,mean2011,
              mean2012,mean2013,mean2014,mean2015,mean2016,mean2017)

yeartab<-c("2000","2001","2002","2003","2004","2005","2006","2007",
           "2008","2009","2010","2011","2012","2013","2014","2015",
           "2016","2017")

meandf<-cbind(yeartab,meantab)
meandf2<-as.data.frame(meandf)

#change values to numeric
meandf2$meantab <- as.numeric(as.character(meandf2$meantab))
meandf2$yeartab <- as.numeric(as.character(meandf2$yeartab))

```

```{r V1G2, echo=FALSE}
library(ggplot2)
options(scipen=10000)

secondplot<-ggplot(meandf2,aes(x=yeartab,y=meantab))+
  geom_line(color="red")+
  
  ggtitle("Prices in Queenstown from 2000")+xlab("Year")+ylab("Resale Amount ($)")+
  theme(
    plot.title=element_text(color="black",size=12,face="bold.italic",hjust=0.5),
    axis.title.x = element_text(color="blue",size=12,face="bold"),
    axis.title.y = element_text(color="blue",size=12,face="bold")
    
  )

library(plotly)
plot2final<-ggplotly(secondplot)
plot2final
```
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

## Visualization 2

```{r V2G1 Code, echo=FALSE, include=FALSE}
#Test with multiple dataset

#Load datasets
mrt <- read.csv("./Datasets/mrtsg.csv")
primaryschool <- read.csv("./Datasets/primaryschoolsg.csv")
attractions <- read.csv("./Datasets/Attractions.csv")
cc <- read.csv("./Datasets/communityclubs.csv")
hawkers <- read.csv("./Datasets/hawkercentre.csv")
institutes <- read.csv("./Datasets/HigherEducationInstitutions.csv")
hospitals <- read.csv("./Datasets/Hospitals.csv")
kindergartens <- read.csv("./Datasets/kindergartens.csv")
parks <- read.csv("./Datasets/Parks.csv")
polyclinics <- read.csv("./Datasets/Polyclinics.csv")
secondaryschool <- read.csv("./Datasets/secondaryschoolsg.csv")
shoppingmall <- read.csv("./Datasets/ShoppingMall.csv")
supermarket <- read.csv("./Datasets/supermarkets.csv")

#Convert to dataframe
mrt <- as.data.frame(mrt)
primaryschool <- as.data.frame(primaryschool)
attractions <- as.data.frame(attractions)
cc <- as.data.frame(cc)
hawkers <- as.data.frame(hawkers)
institutes <- as.data.frame(institutes)
hospitals <- as.data.frame(hospitals)
kindergartens <- as.data.frame(kindergartens)
parks <- as.data.frame(parks)
polyclinics <- as.data.frame(polyclinics)
secondaryschool <- as.data.frame(secondaryschool)
shoppingmall <- as.data.frame(shoppingmall)
supermarket <- as.data.frame(supermarket)

#Identify names
stationname<-mrt$STN_NAME
primaryschoolname <- primaryschool$Name
attractionname <- attractions$Attractions
ccname <- cc$Name
hawkername <- hawkers$Name
institutename <- institutes$Tertiary.Institutions
hospitalname <- hospitals$Hospitals
kindergartenname <- kindergartens$Name
parkname <- parks$Nature.Parks.Gardens
polyclinicname <- polyclinics$Polyclinics
secondaryschoolname <- secondaryschool$SCHNAME
shoppingmallname <- shoppingmall$Shopping.malls
supermarketname <- supermarket$LIC_NAME


#Identify their latitite and longitude
coordinates(mrt) <- ~Longitude + Latitude
coordinates(primaryschool) <- ~Longitude + Latitude
coordinates(attractions) <- ~Longitude + Latitude
coordinates(cc) <- ~X + Y
coordinates(hawkers) <- ~X + Y
coordinates(institutes) <- ~Longitude + Latitude
coordinates(hospitals) <- ~Longitude + Latitude
coordinates(kindergartens) <- ~X + Y
coordinates(parks) <- ~Longitude + Latitude
coordinates(polyclinics) <- ~Longitude + Latitude
coordinates(secondaryschool) <- ~longitude + latitude
coordinates(shoppingmall) <- ~Longitude + Latitude
coordinates(supermarket) <- ~X + Y

#MRT Colours
pal <- colorFactor(levels = c("RED","BLUE","GREEN","YELLOW","PURPLE","BROWN","GREY"),
                   palette = c("red","blue","green","yellow","purple","brown","grey"))
```

```{r V2G1, echo=FALSE}
#Add markers to map
leaflet() %>%
  addTiles() %>%
  addCircleMarkers(data=mrt,
                   radius=8, 
                   stroke=1, 
                   color=~pal(COLOR),
                   fillColor = ~pal(COLOR),
                   popup = stationname,
                   group = "MRT") %>%
  addMarkers(data=primaryschool, popup = primaryschoolname,
             clusterOptions = markerClusterOptions(),
             group = "Primary School") %>%
  addMarkers(data = attractions, popup = attractionname,
             clusterOptions = markerClusterOptions(),
             group = "Attractions") %>%
  addMarkers(data = cc, popup = ccname,
             clusterOptions = markerClusterOptions(),
             group = "Community Club") %>%
  addMarkers(data = hawkers, popup = hawkername,
             clusterOptions = markerClusterOptions(),
             group = "Hawker Centre") %>%
  addMarkers(data = institutes, popup = institutename,
             clusterOptions = markerClusterOptions(),
             group = "Education Institution") %>%
  addMarkers(data = hospitals, popup = hospitalname,
             clusterOptions = markerClusterOptions(),
             group = "Hospital") %>%
  addMarkers(data = kindergartens, popup = kindergartenname,
             clusterOptions = markerClusterOptions(),
             group = "Kindergarden") %>%
  addMarkers(data = parks, popup = parkname,
             clusterOptions = markerClusterOptions(),
             group = "Parks") %>%
  addMarkers(data = polyclinics, popup = polyclinicname,
             clusterOptions = markerClusterOptions(),
             group = "Polyclinic") %>%
  addMarkers(data = secondaryschool, popup = secondaryschoolname,
             clusterOptions = markerClusterOptions(),
             group = "Secondary School") %>%
  addMarkers(data = shoppingmall, popup = shoppingmallname,
             clusterOptions = markerClusterOptions(),
             group = "Shopping Mall") %>%
  addMarkers(data = supermarket, popup = supermarketname,
             clusterOptions = markerClusterOptions(),
             group = "Supermarket") %>%
  
#Add Layer Control
addLayersControl(
  overlayGroups = c("MRT","Primary School","Attractions","Community Club","Hawker Centre","Education Institution","Hospital","Kindergarden","Parks","Polyclinic","Secondary School","Shopping Mall","Supermarket")
)
```
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.