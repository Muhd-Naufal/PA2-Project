---
title: "R MARKDOWN REPORT"
author: "Javier, E Lynn,AJ, Zulfikar, Ashraf, Naufal"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  prettydoc::html_pretty:
    highlight: github
    theme: cayman
---
  
```{r libraries, include= FALSE}
#install.packages("prettydoc")
library(prettydoc)
library(plyr)
library(dplyr)
library(RColorBrewer)
library(leaflet)
library(geojsonio)
library(ggplot2)
library(gganimate)
library(gifski)
library(data.table)
library(ggrepel)
library(plotly)
library(shiny)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

***
# Contents

* **Headlines**
  + Forecasting Tengah Town
  + Is $1m HDB becoming the norm?
  + Predicting **YOUR MUM**
  
<br>

* **Visualizations**
  + Remaking Our Heartland 
  + Relationship Between POI and Resale Price
  + Why Prices Drastically Increase From 2007 Onwards 
  + Value Comparison Between Mature Towns And Non-Mature Towns
  + Does Premium/Non-standard HDBs account for high resale value? 
  + Compare HDB Median Resale Price Per Town
 
***

## Headlines

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

&nbsp;
&nbsp;

## Headline 1

``` {r Headline 1 Code, echo=FALSE, include=FALSE}

Punggol <- read.csv("./Datasets/HDB Resale Prices.csv")
Punggol$month <- as.Date(paste0(Punggol$month, "-01"), "%Y-%m-%d")
Punggol$year <- format(as.Date(Punggol$month, format="%Y-%m-%d"),"%Y")
Punggol2 <- filter(Punggol, month >= "2007-01-01",town == "PUNGGOL")

type22007<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2007")
type22008<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2008")
type22009<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2009")
type22010<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2010")
type22011<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2011")
type22012<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2012")
type22013<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2013")
type22014<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2014")
type22015<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2015")
type22016<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2016")
type22017<-filter(Punggol2, Punggol2$flat_type=="2 ROOM", Punggol2$year=="2017")

a2007<-as.integer(mean(type22007$resale_price))
a2008<-as.integer(mean(type22008$resale_price))
a2009<-as.integer(mean(type22009$resale_price))
a2010<-as.integer(mean(type22010$resale_price))
a2011<-as.integer(mean(type22011$resale_price))
a2012<-as.integer(mean(type22012$resale_price))
a2013<-as.integer(mean(type22013$resale_price))
a2014<-as.integer(mean(type22014$resale_price))
a2015<-as.integer(mean(type22015$resale_price))
a2016<-as.integer(mean(type22016$resale_price))
a2017<-as.integer(mean(type22017$resale_price))

type32007<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2007")
type32008<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2008")
type32009<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2009")
type32010<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2010")
type32011<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2011")
type32012<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2012")
type32013<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2013")
type32014<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2014")
type32015<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2015")
type32016<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2016")
type32017<-filter(Punggol2, Punggol2$flat_type=="3 ROOM", Punggol2$year == "2017")

b2007<-as.integer(mean(type32007$resale_price))
b2008<-as.integer(mean(type32008$resale_price))
b2009<-as.integer(mean(type32009$resale_price))
b2010<-as.integer(mean(type32010$resale_price))
b2011<-as.integer(mean(type32011$resale_price))
b2012<-as.integer(mean(type32012$resale_price))
b2013<-as.integer(mean(type32013$resale_price))
b2014<-as.integer(mean(type32014$resale_price))
b2015<-as.integer(mean(type32015$resale_price))
b2016<-as.integer(mean(type32016$resale_price))
b2017<-as.integer(mean(type32017$resale_price))

type42007<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2007")
type42008<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2008")
type42009<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2009")
type42010<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2010")
type42011<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2011")
type42012<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2012")
type42013<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2013")
type42014<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2014")
type42015<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2015")
type42016<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2016")
type42017<-filter(Punggol2, Punggol2$flat_type=="4 ROOM", Punggol2$year=="2017")

c2007<-as.integer(mean(type42007$resale_price))
c2008<-as.integer(mean(type42008$resale_price))
c2009<-as.integer(mean(type42009$resale_price))
c2010<-as.integer(mean(type42010$resale_price))
c2011<-as.integer(mean(type42011$resale_price))
c2012<-as.integer(mean(type42012$resale_price))
c2013<-as.integer(mean(type42013$resale_price))
c2014<-as.integer(mean(type42014$resale_price))
c2015<-as.integer(mean(type42015$resale_price))
c2016<-as.integer(mean(type42016$resale_price))
c2017<-as.integer(mean(type42017$resale_price))

type52007<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2007")
type52008<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2008")
type52009<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2009")
type52010<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2010")
type52011<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2011")
type52012<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2012")
type52013<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2013")
type52014<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2014")
type52015<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2015")
type52016<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2016")
type52017<-filter(Punggol2, Punggol2$flat_type=="5 ROOM", Punggol2$year == "2017")

d2007<-as.integer(mean(type52007$resale_price))
d2008<-as.integer(mean(type52008$resale_price))
d2009<-as.integer(mean(type52009$resale_price))
d2010<-as.integer(mean(type52010$resale_price))
d2011<-as.integer(mean(type52011$resale_price))
d2012<-as.integer(mean(type52012$resale_price))
d2013<-as.integer(mean(type52013$resale_price))
d2014<-as.integer(mean(type52014$resale_price))
d2015<-as.integer(mean(type52015$resale_price))
d2016<-as.integer(mean(type52016$resale_price))
d2017<-as.integer(mean(type52017$resale_price))

type62007<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2007")
type62008<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2008")
type62009<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2009")
type62010<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2010")
type62011<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2011")
type62012<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2012")
type62013<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2013")
type62014<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2014")
type62015<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2015")
type62016<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2016")
type62017<-filter(Punggol2, Punggol2$flat_type=="EXECUTIVE", Punggol2$year == "2017")

e2007<-as.integer(mean(type62007$resale_price))
e2008<-as.integer(mean(type62008$resale_price))
e2009<-as.integer(mean(type62009$resale_price))
e2010<-as.integer(mean(type62010$resale_price))
e2011<-as.integer(mean(type62011$resale_price))
e2012<-as.integer(mean(type62012$resale_price))
e2013<-as.integer(mean(type62013$resale_price))
e2014<-as.integer(mean(type62014$resale_price))
e2015<-as.integer(mean(type62015$resale_price))
e2016<-as.integer(mean(type62016$resale_price))
e2017<-as.integer(mean(type62017$resale_price))

type4and52007<-filter(Punggol2, Punggol2$year=="2007"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52008<-filter(Punggol2, Punggol2$year=="2008"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52009<-filter(Punggol2, Punggol2$year=="2009"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52010<-filter(Punggol2, Punggol2$year=="2010"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52011<-filter(Punggol2, Punggol2$year=="2011"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52012<-filter(Punggol2, Punggol2$year=="2012"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52013<-filter(Punggol2, Punggol2$year=="2013"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type4and52014<-filter(Punggol2, Punggol2$year=="2014"| Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type23452015<-filter(Punggol2, Punggol2$year=="2015"| Punggol2$flat_type=="2 ROOM"& Punggol2$flat_type=="3 ROOM"&Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type23452016<-filter(Punggol2, Punggol2$year=="2016"| Punggol2$flat_type=="2 ROOM"& Punggol2$flat_type=="3 ROOM"&Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")
type23452017<-filter(Punggol2, Punggol2$year=="2017"| Punggol2$flat_type=="2 ROOM"& Punggol2$flat_type=="3 ROOM"&Punggol2$flat_type=="4 ROOM"& Punggol2$flat_type=="5 ROOM")

f2007<-as.integer(mean(type4and52007$resale_price))
f2008<-as.integer(mean(type4and52008$resale_price))
f2009<-as.integer(mean(type4and52009$resale_price))
f2010<-as.integer(mean(type4and52010$resale_price))
f2011<-as.integer(mean(type4and52011$resale_price))
f2012<-as.integer(mean(type4and52012$resale_price))
f2013<-as.integer(mean(type4and52013$resale_price))
f2014<-as.integer(mean(type4and52014$resale_price))
f2015<-as.integer(mean(type23452015$resale_price))
f2016<-as.integer(mean(type23452016$resale_price))
f2017<-as.integer(mean(type23452017$resale_price))

Year <- c("2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017")

tworoom <- c(a2007,a2008,a2009,a2010,a2011,a2012,a2013,a2014,a2015,a2016,a2017)
threeroom <- c(b2007,b2008,b2009,b2010,b2011,b2012,b2013,b2014,b2015,b2016,b2017)
fourroom <- c(c2007,c2008,c2009,c2010,c2011,c2012,c2013,c2014,c2015,c2016,c2017)
fiveroom <- c(d2007,d2008,d2009,d2010,d2011,d2012,d2013,d2014,d2015,d2016,d2017)
executive <- c(e2007,e2008,e2009,e2010,e2011,e2012,e2013,e2014,e2015,e2016,e2017)
average <- c(f2007,f2008,f2009,f2010,f2011,f2012,f2013,f2014,f2015,f2016,f2017)

Punggoldf <- data.frame(Year,tworoom,threeroom,fourroom,fiveroom,executive,average)

is.nan.data.frame <- function(x)
  do.call(cbind, lapply(x, is.nan))

Punggoldf[is.nan(Punggoldf)] <- 0
```

```{r Headline 1, message = FALSE, warning = FALSE, echo=FALSE }

plot_ly(
  type = 'table',
  header = list(
    values = c('<b>YEAR</b>', '<b>2 Room</b>','<b>3 Room</b>','<b>4 Room</b>','<b>5 Room</b>','<b>Executive<b>','<b>Total<b>'),
    line = list(color = '#506784'),
    fill = list(color = 'red'),
    align = c('left','center'),
    font = list(color = 'black', size = 12)
  ),
  cells = list(
    values = rbind(
      c("2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017", '<b>2008 vs 2018</b>'),
      c(a2007,a2008,a2009,a2010,a2011,a2012,a2013,a2014,a2015,a2016,a2017,"null"),
      c(b2007,b2008,b2009,b2010,b2011,b2012,b2013,b2014,b2015,b2016,b2017,"null"),
      c(c2007,c2008,c2009,c2010,c2011,c2012,c2013,c2014,c2015,c2016,c2017,"71.4%"),
      c(d2007,d2008,d2009,d2010,d2011,d2012,d2013,d2014,d2015,d2016,d2017,"48.2%"),
      c(e2007,e2008,e2009,e2010,e2011,e2012,e2013,e2014,e2015,e2016,e2017,"41.6%"),
      c(f2007,f2008,f2009,f2010,f2011,f2012,f2013,f2014,f2015,f2016,f2017,"50.5%")),
    line = list(color = '#506784'),
    fill = list(color = c('red', 'white')),
    align = c('left', 'center'),
    font = list(color = c('black'), size = 12)
  ))
```

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

```{r message = FALSE, warning = FALSE, results = FALSE,echo=FALSE}

Price <- c(a2007,a2008,a2009,a2010,a2011,a2012,a2013,a2014,a2015,a2016,a2017,
           b2007,b2008,b2009,b2010,b2011,b2012,b2013,b2014,b2015,b2016,b2017,
           c2007,c2008,c2009,c2010,c2011,c2012,c2013,c2014,c2015,c2016,c2017,
           d2007,d2008,d2009,d2010,d2011,d2012,d2013,d2014,d2015,d2016,d2017,
           e2007,e2008,e2009,e2010,e2011,e2012,e2013,e2014,e2015,e2016,e2017,
           f2007,f2008,f2009,f2010,f2011,f2012,f2013,f2014,f2015,f2016,f2017)

Years <- c("2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017",
           "2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017")

Flat_Type <- c("2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room","2 Room",
               "3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room","3 Room",
               "4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room","4 Room",
               "5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room","5 Room",
               "Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive","Executive",
               "Average","Average","Average","Average","Average","Average","Average","Average","Average","Average","Average")

kgif <- data.frame(Price,Years,Flat_Type)
kgif$Price <- as.numeric(as.character(kgif$Price))
kgif$Years <- as.numeric(as.character(kgif$Years))

```

```{r message = FALSE, warning = FALSE, results = FALSE, echo=FALSE}
k <- ggplot(
  kgif,
  aes(Years,Price, group = Flat_Type, color = factor(Flat_Type), label = Flat_Type)
) +
  geom_line() +
  scale_color_viridis_d() +
  labs(x = "Years", y = "Yceffc") +
  ggtitle("TITLE") +
  theme(legend.position = "top") +
  guides(color=guide_legend(title="Flat Type")) +
  geom_label() +
  geom_point(aes(group = seq_along(Years)), size = 7) +
  transition_reveal(Years)

anim_save("k.gif", k)
```

![](k.gif)
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.


## Headline 2

```{r stack code, echo=FALSE, include=FALSE}

hdb2 <- read.csv("./Datasets/HDB Resale Prices.csv")

hdb2$month <- as.Date(paste0(hdb2$month, "-01"), "%Y-%m-%d")

hdb3 <- filter(hdb2, month >= "2012-01-01")

hdb4 <- filter(hdb3, flat_type == "4 ROOM" | 
                     flat_type == "5 ROOM" | 
                     flat_type == "EXECUTIVE" | 
                     flat_type == "MULTI-GENERATION")

hdb5 <- filter(hdb4, resale_price >= 900000)

hdb6 <- count(hdb5, "flat_type")

hdb7 <- data.frame(hdb5$flat_type, hdb5$resale_price, hdb5$month)

hdb7$hdb5.resale_price <- 1

sum(hdb7$hdb5.resale_price)
```

```{r stack, echo=FALSE}
setDT(hdb7)[,hdb5.month := as.IDate(hdb5.month)]
ggplot(hdb7[,sum(hdb5.resale_price), by=.(hdb5.flat_type, year(hdb5.month))], aes(x=year, y=V1, fill=hdb5.flat_type)) +
  geom_bar(stat = "identity") +
  geom_label_repel(aes(label=V1), vjust=0) +
  ggtitle("Resale flats above $900K by Year") +
  xlab("Year") + ylab("Transaction Volume") +
  labs(fill='Flat Type') 
```

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

```{r message = FALSE, warning = FALSE, results = FALSE,echo=FALSE}
hdb8 <- filter(hdb3, flat_type == "4 ROOM" | 
                 flat_type == "5 ROOM" | 
                 flat_type == "EXECUTIVE" | 
                 flat_type == "MULTI-GENERATION")

hdb9 <- data.frame(hdb8$flat_type, hdb8$month)

hdb9$year <- substring(hdb9$hdb8.month,1,4)

i <- sapply(hdb9, is.factor)
hdb9[i] <- lapply(hdb9[i], as.character)

hdb9$year <- as.numeric(as.character(hdb9$year))

hdb4R2012 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2012'))
hdb5R2012 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2012'))
hdbEX2012 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2012'))
hdbMG2012 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2012'))

hdb4R2013 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2013'))
hdb5R2013 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2013'))
hdbEX2013 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2013'))
hdbMG2013 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2013'))

hdb4R2014 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2014'))
hdb5R2014 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2014'))
hdbEX2014 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2014'))
hdbMG2014 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2014'))

hdb4R2015 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2015'))
hdb5R2015 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2015'))
hdbEX2015 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2015'))
hdbMG2015 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2015'))

hdb4R2016 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2016'))
hdb5R2016 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2016'))
hdbEX2016 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2016'))
hdbMG2016 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2016'))

hdb4R2017 <- nrow(subset(hdb9,hdb8.flat_type == '4 ROOM' & hdb9$year=='2017'))
hdb5R2017 <- nrow(subset(hdb9,hdb8.flat_type == '5 ROOM' & hdb9$year=='2017'))
hdbEX2017 <- nrow(subset(hdb9,hdb8.flat_type == 'EXECUTIVE' & hdb9$year=='2017'))
hdbMG2017 <- nrow(subset(hdb9,hdb8.flat_type == 'MULTI-GENERATION' & hdb9$year=='2017'))

Volume <- c(hdb4R2012,hdb4R2013,hdb4R2014,hdb4R2015,hdb4R2016,hdb4R2017,
            hdb5R2012,hdb5R2013,hdb5R2014,hdb5R2015,hdb5R2016,hdb5R2017,
            hdbEX2012,hdbEX2013,hdbEX2014,hdbEX2015,hdbEX2016,hdbEX2017,
            hdbMG2012,hdbMG2013,hdbMG2014,hdbMG2015,hdbMG2016,hdbMG2017)


Flat_Type <- c("4 Room","4 Room","4 Room","4 Room","4 Room","4 Room",
               "5 Room","5 Room","5 Room","5 Room","5 Room","5 Room",
               "Executive","Executive","Executive","Executive","Executive","Executive",
               "Multi-Generation","Multi-Generation","Multi-Generation","Multi-Generation","Multi-Generation","Multi-Generation")

Year <- c("2012","2013","2014","2015","2016","2017",
          "2012","2013","2014","2015","2016","2017",
          "2012","2013","2014","2015","2016","2017",
          "2012","2013","2014","2015","2016","2017")


finalhdb <- data.frame(Volume,Year,Flat_Type)

finalhdb$Year <- as.numeric(as.character(finalhdb$Year))
```

```{r message = FALSE, warning = FALSE, results = FALSE, echo=FALSE}
p <- ggplot(
  finalhdb,
  aes(Year,Volume, group = Flat_Type, color = factor(Flat_Type), label = Flat_Type)
) +
  geom_line() +
  scale_color_viridis_d() +
  labs(x = "Years", y = "Transaction Volume") +
  ggtitle("Volume of flats sold over the years") +
  theme(legend.position = "top") +
  guides(color=guide_legend(title="Flat Type")) +
  geom_label() +
  geom_point(aes(group = seq_along(Year)), size = 7) +
  transition_reveal(Year)

anim_save("p.gif", p)

```

![](p.gif)
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

## Predictive Model

Still trying to make it work...





